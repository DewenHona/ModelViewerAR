<html>

<head>
    <title>modelViewer</title>

    <!-- CUSTOM CSS and JS -->
    <link rel="stylesheet" href="./styles.css">

    <script src="https://unpkg.com/focus-visible@5.0.2/dist/focus-visible.js" defer></script>

</head>

<body>
    <div id="model-div">
        <model-viewer src="./assets/models/sunflower.glb" poster="./assets/images/sunflower.png" shadow-intensity="1" ar
            ar-modes="webxr scene-viewer quick-look" camera-controls skybox-image="./assets/images/skyboxforest.hdr"
            alt=" A 3D model carousel">

            <button slot="ar-button" id="ar-button">&nbsp;AR</button>

            <div id="ar-prompt">
                <img src="./assets/images/hand.png">
            </div>

            <button id="ar-failure">
                AR is not tracking!
            </button>

            <!-- button audio-start -->
            <audio loop id="sound-aud" src="/assets/audio/sunflower.wav" preload="auto"></audio>
            <button id="sound-btn" onclick="document.getElementById('sound-aud').play();">Audio</button>
            <!-- button audio-end -->

            <!-- interactions-Start -->
            <div id="interactions">

                <div id="story">
                    <!-- Slider-start -->
                    <div class="slider">
                        <div class="slides">
                            <button class="slide selected" onclick="switchSrc(this, 'sunflower')"
                                style="background-image: url('./assets/images/sunflower.png');">
                            </button>

                            <button class="slide" onclick="switchSrc(this, 'fox')"
                                style="background-image: url('./assets/images/fox.png');">

                            </button>

                            <button class="slide" onclick="switchSrc(this, 'earth')"
                                style="background-image: url('./assets/images/earth.png');">
                            </button>

                            <button class="slide" onclick="switchSrc(this, 'RobotExpressive')"
                                style="background-image: url('./assets/images/RobotExpressive.png');">
                            </button>

                            <button class="slide" onclick="switchSrc(this, 'DanceRobot')"
                                style="background-image: url('./assets/images/DanceRobot.png');">
                            </button>

                            <button class="slide" onclick="switchSrc(this, 'Peacock')"
                                style="background-image: url('./assets/images/Peacock.png');">
                            </button>
                        </div>
                    </div>
                    <!-- Slider-end -->

                </div>
                <!-- interactions-end -->

        </model-viewer>
    </div>

    <script type="module">
        const modelViewer = document.querySelector("model-viewer");

        window.switchSrc = (element, name) => {
            const base = "./assets/";
            modelViewer.src = base + "models/" + name + '.glb';
            modelViewer.poster = base + "images/" + name + '.png';
            const slides = document.querySelectorAll(".slide");
            slides.forEach((element) => { element.classList.remove("selected"); });
            element.classList.add("selected");

            //add sound src dynamically
            const path = "./assets/audio/";
            var audiofile = document.getElementById('sound-aud').src = path + name + '.wav';

            //src="/assets/audio/fox.wav"

            // ANIMATION 
            if (name == "RobotExpressive") {
                modelViewer.setAttribute("animation-name", "Running");
                modelViewer.autoplay = true;
            }
            else {
                modelViewer.setAttribute("animation-name", "false");
                modelViewer.autoplay = false;
            }
        };

        document.querySelector(".slider").addEventListener('beforexrselect', (ev) => {
            // Keep slider interactions from affecting the XR scene.
            ev.preventDefault();
        });


    </script>

    <!-- MISC -->
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js">
    </script>
    <!-- Loads <model-viewer> for old browsers like IE11: -->
    <script nomodule src="https://unpkg.com/@google/model-viewer/dist/model-viewer-legacy.js">
    </script>


</body>

</html>